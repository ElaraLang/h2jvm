<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE OverloadedRecordDot #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html"><span class="hs-identifier">JVM.Data.Convert.ConstantPool</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.IndexedMap.html"><span class="hs-identifier">Data.IndexedMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IndexedMap.html#IndexedMap"><span class="hs-identifier">IndexedMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.IndexedMap.html"><span class="hs-identifier">Data.IndexedMap</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IM</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Tuple</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">swap</span></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html"><span class="hs-identifier">JVM.Data.Abstract.ConstantPool</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="JVM.Data.Convert.Descriptor.html"><span class="hs-identifier">JVM.Data.Convert.Descriptor</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="JVM.Data.Convert.Numbers.html"><span class="hs-identifier">JVM.Data.Convert.Numbers</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="JVM.Data.Convert.Type.html"><span class="hs-identifier">JVM.Data.Convert.Type</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="JVM.Data.Raw.ClassFile.html"><span class="hs-identifier">JVM.Data.Raw.ClassFile</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Raw</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="JVM.Data.Raw.ConstantPool.html"><span class="hs-identifier">JVM.Data.Raw.ConstantPool</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="JVM.Data.Raw.MagicNumbers.html"><span class="hs-identifier">JVM.Data.Raw.MagicNumbers</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="JVM.Data.Raw.Types.html"><span class="hs-identifier">JVM.Data.Raw.Types</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.html"><span class="hs-identifier">Effectful</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.State.Static.Local.html"><span class="hs-identifier">Effectful.State.Static.Local</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/1n6w79d9zhghgpcih7nwfq3bk7f2g4ni-effectful-th-1.0.0.3-doc/share/doc/effectful-th-1.0.0.3/html/src/Effectful.TH.html"><span class="hs-identifier">Effectful.TH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/1n6w79d9zhghgpcih7nwfq3bk7f2g4ni-effectful-th-1.0.0.3-doc/share/doc/effectful-th-1.0.0.3/html/src/Effectful.TH.html#makeEffect"><span class="hs-identifier">makeEffect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Dispatch.Dynamic.html"><span class="hs-identifier">Effectful.Dispatch.Dynamic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Dispatch.Dynamic.html#interpret"><span class="hs-identifier">interpret</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">data</span><span> </span><span id="ConstantPoolState"><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPoolState"><span class="hs-identifier hs-var">ConstantPoolState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ConstantPoolState"><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPoolState"><span class="hs-identifier hs-var">ConstantPoolState</span></a></span></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="constantPool"><span class="annot"><span class="annottext">ConstantPoolState -&gt; IndexedMap ConstantPoolInfo
</span><a href="JVM.Data.Convert.ConstantPool.html#constantPool"><span class="hs-identifier hs-var hs-var">constantPool</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IndexedMap.html#IndexedMap"><span class="hs-identifier hs-type">IndexedMap</span></a></span><span> </span><span class="annot"><a href="JVM.Data.Raw.ConstantPool.html#ConstantPoolInfo"><span class="hs-identifier hs-type">ConstantPoolInfo</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="bootstrapMethods"><span class="annot"><span class="annottext">ConstantPoolState -&gt; IndexedMap BootstrapMethod
</span><a href="JVM.Data.Convert.ConstantPool.html#bootstrapMethods"><span class="hs-identifier hs-var hs-var">bootstrapMethods</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IndexedMap.html#IndexedMap"><span class="hs-identifier hs-type">IndexedMap</span></a></span><span> </span><span class="annot"><a href="JVM.Data.Raw.ClassFile.html#BootstrapMethod"><span class="hs-identifier hs-type">Raw.BootstrapMethod</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679453200"><span id="local-6989586621679453209"><span id="local-6989586621679453213"><span class="annot"><span class="annottext">Int -&gt; ConstantPoolState -&gt; ShowS
[ConstantPoolState] -&gt; ShowS
ConstantPoolState -&gt; String
(Int -&gt; ConstantPoolState -&gt; ShowS)
-&gt; (ConstantPoolState -&gt; String)
-&gt; ([ConstantPoolState] -&gt; ShowS)
-&gt; Show ConstantPoolState
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; ConstantPoolState -&gt; ShowS
showsPrec :: Int -&gt; ConstantPoolState -&gt; ShowS
$cshow :: ConstantPoolState -&gt; String
show :: ConstantPoolState -&gt; String
$cshowList :: [ConstantPoolState] -&gt; ShowS
showList :: [ConstantPoolState] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679453220"><span id="local-6989586621679453227"><span class="annot"><span class="annottext">ConstantPoolState -&gt; ConstantPoolState -&gt; Bool
(ConstantPoolState -&gt; ConstantPoolState -&gt; Bool)
-&gt; (ConstantPoolState -&gt; ConstantPoolState -&gt; Bool)
-&gt; Eq ConstantPoolState
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: ConstantPoolState -&gt; ConstantPoolState -&gt; Bool
== :: ConstantPoolState -&gt; ConstantPoolState -&gt; Bool
$c/= :: ConstantPoolState -&gt; ConstantPoolState -&gt; Bool
/= :: ConstantPoolState -&gt; ConstantPoolState -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679453236"><span id="local-6989586621679453243"><span id="local-6989586621679453249"><span id="local-6989586621679453253"><span id="local-6989586621679453256"><span id="local-6989586621679453259"><span id="local-6989586621679453262"><span class="annot"><span class="annottext">Eq ConstantPoolState
Eq ConstantPoolState =&gt;
(ConstantPoolState -&gt; ConstantPoolState -&gt; Ordering)
-&gt; (ConstantPoolState -&gt; ConstantPoolState -&gt; Bool)
-&gt; (ConstantPoolState -&gt; ConstantPoolState -&gt; Bool)
-&gt; (ConstantPoolState -&gt; ConstantPoolState -&gt; Bool)
-&gt; (ConstantPoolState -&gt; ConstantPoolState -&gt; Bool)
-&gt; (ConstantPoolState -&gt; ConstantPoolState -&gt; ConstantPoolState)
-&gt; (ConstantPoolState -&gt; ConstantPoolState -&gt; ConstantPoolState)
-&gt; Ord ConstantPoolState
ConstantPoolState -&gt; ConstantPoolState -&gt; Bool
ConstantPoolState -&gt; ConstantPoolState -&gt; Ordering
ConstantPoolState -&gt; ConstantPoolState -&gt; ConstantPoolState
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: ConstantPoolState -&gt; ConstantPoolState -&gt; Ordering
compare :: ConstantPoolState -&gt; ConstantPoolState -&gt; Ordering
$c&lt; :: ConstantPoolState -&gt; ConstantPoolState -&gt; Bool
&lt; :: ConstantPoolState -&gt; ConstantPoolState -&gt; Bool
$c&lt;= :: ConstantPoolState -&gt; ConstantPoolState -&gt; Bool
&lt;= :: ConstantPoolState -&gt; ConstantPoolState -&gt; Bool
$c&gt; :: ConstantPoolState -&gt; ConstantPoolState -&gt; Bool
&gt; :: ConstantPoolState -&gt; ConstantPoolState -&gt; Bool
$c&gt;= :: ConstantPoolState -&gt; ConstantPoolState -&gt; Bool
&gt;= :: ConstantPoolState -&gt; ConstantPoolState -&gt; Bool
$cmax :: ConstantPoolState -&gt; ConstantPoolState -&gt; ConstantPoolState
max :: ConstantPoolState -&gt; ConstantPoolState -&gt; ConstantPoolState
$cmin :: ConstantPoolState -&gt; ConstantPoolState -&gt; ConstantPoolState
min :: ConstantPoolState -&gt; ConstantPoolState -&gt; ConstantPoolState
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="annot"><span class="hs-comment">-- | Effect for managing the constant pool state</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">data</span><span> </span><span id="ConstantPool"><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPool"><span class="hs-identifier hs-var">ConstantPool</span></a></span></span><span> </span><span id="local-6989586621679453271"><span class="annot"><a href="#local-6989586621679453271"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679453272"><span class="annot"><a href="#local-6989586621679453272"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-34"></span><span>    </span><span id="local-6989586621679453071"><span id="GetCP"><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#GetCP"><span class="hs-identifier hs-var">GetCP</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPool"><span class="hs-identifier hs-type">ConstantPool</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453071"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPoolState"><span class="hs-identifier hs-type">ConstantPoolState</span></a></span></span><span>
</span><span id="line-35"></span><span>    </span><span id="local-6989586621679453072"><span id="SetCP"><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#SetCP"><span class="hs-identifier hs-var">SetCP</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPoolState"><span class="hs-identifier hs-type">ConstantPoolState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPool"><span class="hs-identifier hs-type">ConstantPool</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453072"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span id="local-6989586621679453057"><span id="local-6989586621679453060"><span id="local-6989586621679453061"><span id="local-6989586621679453062"><span id="DispatchOf"><span id="getCP"><span id="setCP"><span class="hs-identifier">makeEffect</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">ConstantPool</span></span></span></span></span></span></span></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span id="local-6989586621679453076"><span id="local-6989586621679453077"><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMOver"><span class="hs-identifier hs-type">lookupOrInsertMOver</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPool"><span class="hs-identifier hs-type">ConstantPool</span></a></span><span>  </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453076"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679453077"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679453077"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPoolState"><span class="hs-identifier hs-type">ConstantPoolState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IndexedMap.html#IndexedMap"><span class="hs-identifier hs-type">IndexedMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453077"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPoolState"><span class="hs-identifier hs-type">ConstantPoolState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IndexedMap.html#IndexedMap"><span class="hs-identifier hs-type">IndexedMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453077"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPoolState"><span class="hs-identifier hs-type">ConstantPoolState</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679453076"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span><span>
</span><span id="line-40"></span><span id="lookupOrInsertMOver"><span class="annot"><span class="annottext">lookupOrInsertMOver :: forall (r :: [Effect]) a.
(ConstantPool :&gt; r, Ord a) =&gt;
a
-&gt; (ConstantPoolState -&gt; IndexedMap a)
-&gt; (ConstantPoolState -&gt; IndexedMap a -&gt; ConstantPoolState)
-&gt; Eff r Int
</span><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMOver"><span class="hs-identifier hs-var hs-var">lookupOrInsertMOver</span></a></span></span><span> </span><span id="local-6989586621679453308"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679453308"><span class="hs-identifier hs-var">cpInfo</span></a></span></span><span> </span><span id="local-6989586621679453309"><span class="annot"><span class="annottext">ConstantPoolState -&gt; IndexedMap a
</span><a href="#local-6989586621679453309"><span class="hs-identifier hs-var">get</span></a></span></span><span> </span><span id="local-6989586621679453310"><span class="annot"><span class="annottext">ConstantPoolState -&gt; IndexedMap a -&gt; ConstantPoolState
</span><a href="#local-6989586621679453310"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-41"></span><span>    </span><span id="local-6989586621679453311"><span class="annot"><a href="#local-6989586621679453311"><span class="hs-identifier hs-var">cp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff r ConstantPoolState
forall {k} (es :: [Effect]).
(HasCallStack, ConstantPool :&gt; es) =&gt;
Eff es ConstantPoolState
</span><a href="JVM.Data.Convert.ConstantPool.html#getCP"><span class="hs-identifier hs-var">getCP</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679453312"><span class="annot"><a href="#local-6989586621679453312"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679453313"><span class="annot"><a href="#local-6989586621679453313"><span class="hs-identifier hs-var">newCP</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.IndexedMap.html#lookupOrInsert"><span class="hs-identifier hs-type">IM.lookupOrInsert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453308"><span class="hs-identifier hs-type">cpInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679453309"><span class="hs-identifier hs-type">get</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453311"><span class="hs-identifier hs-type">cp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#setCP"><span class="hs-identifier hs-type">setCP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679453310"><span class="hs-identifier hs-type">set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453311"><span class="hs-identifier hs-type">cp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453313"><span class="hs-identifier hs-type">newCP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621679453312"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span id="local-6989586621679453085"><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMCP"><span class="hs-identifier hs-type">lookupOrInsertMCP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPool"><span class="hs-identifier hs-type">ConstantPool</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453085"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="JVM.Data.Raw.ConstantPool.html#ConstantPoolInfo"><span class="hs-identifier hs-type">ConstantPoolInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453085"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-47"></span><span id="lookupOrInsertMCP"><span class="annot"><span class="annottext">lookupOrInsertMCP :: forall (r :: [Effect]).
(ConstantPool :&gt; r) =&gt;
ConstantPoolInfo -&gt; Eff r Int
</span><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMCP"><span class="hs-identifier hs-var hs-var">lookupOrInsertMCP</span></a></span></span><span> </span><span id="local-6989586621679453320"><span class="annot"><span class="annottext">ConstantPoolInfo
</span><a href="#local-6989586621679453320"><span class="hs-identifier hs-var">cpInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstantPoolInfo
-&gt; (ConstantPoolState -&gt; IndexedMap ConstantPoolInfo)
-&gt; (ConstantPoolState
    -&gt; IndexedMap ConstantPoolInfo -&gt; ConstantPoolState)
-&gt; Eff r Int
forall (r :: [Effect]) a.
(ConstantPool :&gt; r, Ord a) =&gt;
a
-&gt; (ConstantPoolState -&gt; IndexedMap a)
-&gt; (ConstantPoolState -&gt; IndexedMap a -&gt; ConstantPoolState)
-&gt; Eff r Int
</span><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMOver"><span class="hs-identifier hs-var">lookupOrInsertMOver</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantPoolInfo
</span><a href="#local-6989586621679453320"><span class="hs-identifier hs-var">cpInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-operator">.</span><span class="hs-identifier">constantPool</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679453321"><span class="annot"><span class="annottext">ConstantPoolState
</span><a href="#local-6989586621679453321"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679453322"><span class="annot"><span class="annottext">IndexedMap ConstantPoolInfo
</span><a href="#local-6989586621679453322"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConstantPoolState
</span><a href="#local-6989586621679453321"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">{</span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#constantPool"><span class="hs-identifier hs-var">constantPool</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679453322"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span id="local-6989586621679453087"><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMBM"><span class="hs-identifier hs-type">lookupOrInsertMBM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPool"><span class="hs-identifier hs-type">ConstantPool</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453087"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="JVM.Data.Raw.ClassFile.html#BootstrapMethod"><span class="hs-identifier hs-type">Raw.BootstrapMethod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453087"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-50"></span><span id="lookupOrInsertMBM"><span class="annot"><span class="annottext">lookupOrInsertMBM :: forall (r :: [Effect]).
(ConstantPool :&gt; r) =&gt;
BootstrapMethod -&gt; Eff r Int
</span><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMBM"><span class="hs-identifier hs-var hs-var">lookupOrInsertMBM</span></a></span></span><span> </span><span id="local-6989586621679453328"><span class="annot"><span class="annottext">BootstrapMethod
</span><a href="#local-6989586621679453328"><span class="hs-identifier hs-var">bmInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BootstrapMethod
-&gt; (ConstantPoolState -&gt; IndexedMap BootstrapMethod)
-&gt; (ConstantPoolState
    -&gt; IndexedMap BootstrapMethod -&gt; ConstantPoolState)
-&gt; Eff r Int
forall (r :: [Effect]) a.
(ConstantPool :&gt; r, Ord a) =&gt;
a
-&gt; (ConstantPoolState -&gt; IndexedMap a)
-&gt; (ConstantPoolState -&gt; IndexedMap a -&gt; ConstantPoolState)
-&gt; Eff r Int
</span><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMOver"><span class="hs-identifier hs-var">lookupOrInsertMOver</span></a></span><span> </span><span class="annot"><span class="annottext">BootstrapMethod
</span><a href="#local-6989586621679453328"><span class="hs-identifier hs-var">bmInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-operator">.</span><span class="hs-identifier">bootstrapMethods</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679453329"><span class="annot"><span class="annottext">ConstantPoolState
</span><a href="#local-6989586621679453329"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679453330"><span class="annot"><span class="annottext">IndexedMap BootstrapMethod
</span><a href="#local-6989586621679453330"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConstantPoolState
</span><a href="#local-6989586621679453329"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">{</span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#bootstrapMethods"><span class="hs-identifier hs-var">bootstrapMethods</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679453330"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span id="local-6989586621679453089"><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-type">transformEntry</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPool"><span class="hs-identifier hs-type">ConstantPool</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453089"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#ConstantPoolEntry"><span class="hs-identifier hs-type">ConstantPoolEntry</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453089"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-53"></span><span id="transformEntry"><span class="annot"><span class="annottext">transformEntry :: forall (r :: [Effect]).
(ConstantPool :&gt; r) =&gt;
ConstantPoolEntry -&gt; Eff r Int
</span><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-var hs-var">transformEntry</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#CPUTF8Entry"><span class="hs-identifier hs-type">CPUTF8Entry</span></a></span><span> </span><span id="local-6989586621679453440"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679453440"><span class="hs-identifier hs-var">text</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstantPoolInfo -&gt; Eff r Int
forall (r :: [Effect]).
(ConstantPool :&gt; r) =&gt;
ConstantPoolInfo -&gt; Eff r Int
</span><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMCP"><span class="hs-identifier hs-var">lookupOrInsertMCP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ConstantPoolInfo
</span><a href="JVM.Data.Raw.ConstantPool.html#UTF8Info"><span class="hs-identifier hs-var">UTF8Info</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ConstantPoolInfo) -&gt; ByteString -&gt; ConstantPoolInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679453440"><span class="hs-identifier hs-var">text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-var">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#CPIntegerEntry"><span class="hs-identifier hs-type">CPIntegerEntry</span></a></span><span> </span><span id="local-6989586621679453444"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679453444"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstantPoolInfo -&gt; Eff r Int
forall (r :: [Effect]).
(ConstantPool :&gt; r) =&gt;
ConstantPoolInfo -&gt; Eff r Int
</span><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMCP"><span class="hs-identifier hs-var">lookupOrInsertMCP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">U4 -&gt; ConstantPoolInfo
</span><a href="JVM.Data.Raw.ConstantPool.html#IntegerInfo"><span class="hs-identifier hs-var">IntegerInfo</span></a></span><span> </span><span class="annot"><span class="annottext">(U4 -&gt; ConstantPoolInfo) -&gt; U4 -&gt; ConstantPoolInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; U4
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679453444"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-var">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#CPFloatEntry"><span class="hs-identifier hs-type">CPFloatEntry</span></a></span><span> </span><span id="local-6989586621679453447"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679453447"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstantPoolInfo -&gt; Eff r Int
forall (r :: [Effect]).
(ConstantPool :&gt; r) =&gt;
ConstantPoolInfo -&gt; Eff r Int
</span><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMCP"><span class="hs-identifier hs-var">lookupOrInsertMCP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">U4 -&gt; ConstantPoolInfo
</span><a href="JVM.Data.Raw.ConstantPool.html#FloatInfo"><span class="hs-identifier hs-var">FloatInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; U4
</span><a href="JVM.Data.Convert.Numbers.html#toJVMFloat"><span class="hs-identifier hs-var">toJVMFloat</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679453447"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-var">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#CPStringEntry"><span class="hs-identifier hs-type">CPStringEntry</span></a></span><span> </span><span id="local-6989586621679453451"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679453451"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-57"></span><span>    </span><span id="local-6989586621679453452"><span class="annot"><a href="#local-6989586621679453452"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ConstantPoolEntry -&gt; Eff r Int
forall (r :: [Effect]).
(ConstantPool :&gt; r) =&gt;
ConstantPoolEntry -&gt; Eff r Int
</span><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-var">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ConstantPoolEntry
</span><a href="JVM.Data.Abstract.ConstantPool.html#CPUTF8Entry"><span class="hs-identifier hs-var">CPUTF8Entry</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679453451"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMCP"><span class="hs-identifier hs-type">lookupOrInsertMCP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Raw.ConstantPool.html#StringInfo"><span class="hs-identifier hs-type">StringInfo</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621679453452"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-var">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#CPLongEntry"><span class="hs-identifier hs-type">CPLongEntry</span></a></span><span> </span><span id="local-6989586621679453455"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679453455"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679453456"><span class="annot"><span class="annottext">U4
</span><a href="#local-6989586621679453456"><span class="hs-identifier hs-var">high</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679453457"><span class="annot"><span class="annottext">U4
</span><a href="#local-6989586621679453457"><span class="hs-identifier hs-var">low</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; (U4, U4)
</span><a href="JVM.Data.Convert.Numbers.html#toJVMLong"><span class="hs-identifier hs-var">toJVMLong</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679453455"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><span class="annottext">ConstantPoolInfo -&gt; Eff r Int
forall (r :: [Effect]).
(ConstantPool :&gt; r) =&gt;
ConstantPoolInfo -&gt; Eff r Int
</span><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMCP"><span class="hs-identifier hs-var">lookupOrInsertMCP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">U4 -&gt; U4 -&gt; ConstantPoolInfo
</span><a href="JVM.Data.Raw.ConstantPool.html#LongInfo"><span class="hs-identifier hs-var">LongInfo</span></a></span><span> </span><span class="annot"><span class="annottext">U4
</span><a href="#local-6989586621679453456"><span class="hs-identifier hs-var">high</span></a></span><span> </span><span class="annot"><span class="annottext">U4
</span><a href="#local-6989586621679453457"><span class="hs-identifier hs-var">low</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-var">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#CPDoubleEntry"><span class="hs-identifier hs-type">CPDoubleEntry</span></a></span><span> </span><span id="local-6989586621679453461"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679453461"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679453462"><span class="annot"><span class="annottext">U4
</span><a href="#local-6989586621679453462"><span class="hs-identifier hs-var">high</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679453463"><span class="annot"><span class="annottext">U4
</span><a href="#local-6989586621679453463"><span class="hs-identifier hs-var">low</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; (U4, U4)
</span><a href="JVM.Data.Convert.Numbers.html#toJVMLong"><span class="hs-identifier hs-var">toJVMLong</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Int64
forall b. Integral b =&gt; Double -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679453461"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><span class="annottext">ConstantPoolInfo -&gt; Eff r Int
forall (r :: [Effect]).
(ConstantPool :&gt; r) =&gt;
ConstantPoolInfo -&gt; Eff r Int
</span><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMCP"><span class="hs-identifier hs-var">lookupOrInsertMCP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">U4 -&gt; U4 -&gt; ConstantPoolInfo
</span><a href="JVM.Data.Raw.ConstantPool.html#DoubleInfo"><span class="hs-identifier hs-var">DoubleInfo</span></a></span><span> </span><span class="annot"><span class="annottext">U4
</span><a href="#local-6989586621679453462"><span class="hs-identifier hs-var">high</span></a></span><span> </span><span class="annot"><span class="annottext">U4
</span><a href="#local-6989586621679453463"><span class="hs-identifier hs-var">low</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-var">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#CPClassEntry"><span class="hs-identifier hs-type">CPClassEntry</span></a></span><span> </span><span id="local-6989586621679453467"><span class="annot"><span class="annottext">ClassInfoType
</span><a href="#local-6989586621679453467"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679453468"><span class="annot"><span class="annottext">className :: Text
</span><a href="#local-6989586621679453468"><span class="hs-identifier hs-var hs-var hs-var">className</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClassInfoType -&gt; Text
</span><a href="JVM.Data.Convert.Type.html#classInfoTypeDescriptor"><span class="hs-identifier hs-var">classInfoTypeDescriptor</span></a></span><span> </span><span class="annot"><span class="annottext">ClassInfoType
</span><a href="#local-6989586621679453467"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span id="local-6989586621679453470"><span class="annot"><a href="#local-6989586621679453470"><span class="hs-identifier hs-var">nameIndex</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ConstantPoolEntry -&gt; Eff r Int
forall (r :: [Effect]).
(ConstantPool :&gt; r) =&gt;
ConstantPoolEntry -&gt; Eff r Int
</span><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-var">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ConstantPoolEntry
</span><a href="JVM.Data.Abstract.ConstantPool.html#CPUTF8Entry"><span class="hs-identifier hs-var">CPUTF8Entry</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679453468"><span class="hs-identifier hs-var">className</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMCP"><span class="hs-identifier hs-type">lookupOrInsertMCP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Raw.ConstantPool.html#ClassInfo"><span class="hs-identifier hs-type">ClassInfo</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621679453470"><span class="hs-identifier hs-type">nameIndex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-var">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#CPMethodRefEntry"><span class="hs-identifier hs-type">CPMethodRefEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#MethodRef"><span class="hs-identifier hs-type">MethodRef</span></a></span><span> </span><span id="local-6989586621679453474"><span class="annot"><span class="annottext">ClassInfoType
</span><a href="#local-6989586621679453474"><span class="hs-identifier hs-var">classRef</span></a></span></span><span> </span><span id="local-6989586621679453475"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679453475"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679453476"><span class="annot"><span class="annottext">MethodDescriptor
</span><a href="#local-6989586621679453476"><span class="hs-identifier hs-var">methodDescriptor</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-70"></span><span>    </span><span id="local-6989586621679453477"><span class="annot"><a href="#local-6989586621679453477"><span class="hs-identifier hs-var">classIndex</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ConstantPoolEntry -&gt; Eff r Int
forall (r :: [Effect]).
(ConstantPool :&gt; r) =&gt;
ConstantPoolEntry -&gt; Eff r Int
</span><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-var">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClassInfoType -&gt; ConstantPoolEntry
</span><a href="JVM.Data.Abstract.ConstantPool.html#CPClassEntry"><span class="hs-identifier hs-var">CPClassEntry</span></a></span><span> </span><span class="annot"><span class="annottext">ClassInfoType
</span><a href="#local-6989586621679453474"><span class="hs-identifier hs-var">classRef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>    </span><span id="local-6989586621679453478"><span class="annot"><a href="#local-6989586621679453478"><span class="hs-identifier hs-var">nameAndTypeIndex</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-type">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#CPNameAndTypeEntry"><span class="hs-identifier hs-type">CPNameAndTypeEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453475"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Convert.Descriptor.html#convertMethodDescriptor"><span class="hs-identifier hs-type">convertMethodDescriptor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453476"><span class="hs-identifier hs-type">methodDescriptor</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMCP"><span class="hs-identifier hs-type">lookupOrInsertMCP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Raw.ConstantPool.html#MethodRefInfo"><span class="hs-identifier hs-type">MethodRefInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621679453477"><span class="hs-identifier hs-type">classIndex</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621679453478"><span class="hs-identifier hs-type">nameAndTypeIndex</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-var">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#CPInterfaceMethodRefEntry"><span class="hs-identifier hs-type">CPInterfaceMethodRefEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#MethodRef"><span class="hs-identifier hs-type">MethodRef</span></a></span><span> </span><span id="local-6989586621679453483"><span class="annot"><span class="annottext">ClassInfoType
</span><a href="#local-6989586621679453483"><span class="hs-identifier hs-var">classRef</span></a></span></span><span> </span><span id="local-6989586621679453484"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679453484"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679453485"><span class="annot"><span class="annottext">MethodDescriptor
</span><a href="#local-6989586621679453485"><span class="hs-identifier hs-var">methodDescriptor</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-74"></span><span>    </span><span id="local-6989586621679453486"><span class="annot"><a href="#local-6989586621679453486"><span class="hs-identifier hs-var">classIndex</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ConstantPoolEntry -&gt; Eff r Int
forall (r :: [Effect]).
(ConstantPool :&gt; r) =&gt;
ConstantPoolEntry -&gt; Eff r Int
</span><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-var">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClassInfoType -&gt; ConstantPoolEntry
</span><a href="JVM.Data.Abstract.ConstantPool.html#CPClassEntry"><span class="hs-identifier hs-var">CPClassEntry</span></a></span><span> </span><span class="annot"><span class="annottext">ClassInfoType
</span><a href="#local-6989586621679453483"><span class="hs-identifier hs-var">classRef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>    </span><span id="local-6989586621679453487"><span class="annot"><a href="#local-6989586621679453487"><span class="hs-identifier hs-var">nameAndTypeIndex</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-type">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#CPNameAndTypeEntry"><span class="hs-identifier hs-type">CPNameAndTypeEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453484"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Convert.Descriptor.html#convertMethodDescriptor"><span class="hs-identifier hs-type">convertMethodDescriptor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453485"><span class="hs-identifier hs-type">methodDescriptor</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMCP"><span class="hs-identifier hs-type">lookupOrInsertMCP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Raw.ConstantPool.html#InterfaceMethodRefInfo"><span class="hs-identifier hs-type">InterfaceMethodRefInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621679453486"><span class="hs-identifier hs-type">classIndex</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621679453487"><span class="hs-identifier hs-type">nameAndTypeIndex</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-var">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#CPNameAndTypeEntry"><span class="hs-identifier hs-type">CPNameAndTypeEntry</span></a></span><span> </span><span id="local-6989586621679453489"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679453489"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679453490"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679453490"><span class="hs-identifier hs-var">descriptor</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-78"></span><span>    </span><span id="local-6989586621679453491"><span class="annot"><a href="#local-6989586621679453491"><span class="hs-identifier hs-var">nameIndex</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ConstantPoolEntry -&gt; Eff r Int
forall (r :: [Effect]).
(ConstantPool :&gt; r) =&gt;
ConstantPoolEntry -&gt; Eff r Int
</span><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-var">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ConstantPoolEntry
</span><a href="JVM.Data.Abstract.ConstantPool.html#CPUTF8Entry"><span class="hs-identifier hs-var">CPUTF8Entry</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679453489"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621679453492"><span class="annot"><a href="#local-6989586621679453492"><span class="hs-identifier hs-var">descriptorIndex</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-type">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#CPUTF8Entry"><span class="hs-identifier hs-type">CPUTF8Entry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453490"><span class="hs-identifier hs-type">descriptor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMCP"><span class="hs-identifier hs-type">lookupOrInsertMCP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Raw.ConstantPool.html#NameAndTypeInfo"><span class="hs-identifier hs-type">NameAndTypeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621679453491"><span class="hs-identifier hs-type">nameIndex</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621679453492"><span class="hs-identifier hs-type">descriptorIndex</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-var">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#CPFieldRefEntry"><span class="hs-identifier hs-type">CPFieldRefEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#FieldRef"><span class="hs-identifier hs-type">FieldRef</span></a></span><span> </span><span id="local-6989586621679453496"><span class="annot"><span class="annottext">ClassInfoType
</span><a href="#local-6989586621679453496"><span class="hs-identifier hs-var">classRef</span></a></span></span><span> </span><span id="local-6989586621679453497"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679453497"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679453498"><span class="annot"><span class="annottext">FieldType
</span><a href="#local-6989586621679453498"><span class="hs-identifier hs-var">fieldType</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-82"></span><span>    </span><span id="local-6989586621679453499"><span class="annot"><a href="#local-6989586621679453499"><span class="hs-identifier hs-var">classIndex</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ConstantPoolEntry -&gt; Eff r Int
forall (r :: [Effect]).
(ConstantPool :&gt; r) =&gt;
ConstantPoolEntry -&gt; Eff r Int
</span><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-var">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClassInfoType -&gt; ConstantPoolEntry
</span><a href="JVM.Data.Abstract.ConstantPool.html#CPClassEntry"><span class="hs-identifier hs-var">CPClassEntry</span></a></span><span> </span><span class="annot"><span class="annottext">ClassInfoType
</span><a href="#local-6989586621679453496"><span class="hs-identifier hs-var">classRef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>    </span><span id="local-6989586621679453500"><span class="annot"><a href="#local-6989586621679453500"><span class="hs-identifier hs-var">nameAndTypeIndex</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-type">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#CPNameAndTypeEntry"><span class="hs-identifier hs-type">CPNameAndTypeEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453497"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Convert.Type.html#fieldTypeDescriptor"><span class="hs-identifier hs-type">fieldTypeDescriptor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453498"><span class="hs-identifier hs-type">fieldType</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMCP"><span class="hs-identifier hs-type">lookupOrInsertMCP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Raw.ConstantPool.html#FieldRefInfo"><span class="hs-identifier hs-type">FieldRefInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621679453499"><span class="hs-identifier hs-type">classIndex</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621679453500"><span class="hs-identifier hs-type">nameAndTypeIndex</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-var">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#CPMethodHandleEntry"><span class="hs-identifier hs-type">CPMethodHandleEntry</span></a></span><span> </span><span id="local-6989586621679453504"><span class="annot"><span class="annottext">MethodHandleEntry
</span><a href="#local-6989586621679453504"><span class="hs-identifier hs-var">methodHandleEntry</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679453507"><span class="annot"><span class="annottext">transformFieldMHE :: FieldRef -&gt; Eff r U2
</span><a href="#local-6989586621679453507"><span class="hs-identifier hs-var hs-var hs-var">transformFieldMHE</span></a></span></span><span> </span><span id="local-6989586621679453508"><span class="annot"><span class="annottext">f :: FieldRef
</span><a href="#local-6989586621679453508"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#FieldRef"><span class="hs-identifier hs-type">FieldRef</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstantPoolEntry -&gt; Eff r U2
forall (r :: [Effect]).
(ConstantPool :&gt; r) =&gt;
ConstantPoolEntry -&gt; Eff r U2
</span><a href="JVM.Data.Convert.ConstantPool.html#findIndexOf"><span class="hs-identifier hs-var">findIndexOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldRef -&gt; ConstantPoolEntry
</span><a href="JVM.Data.Abstract.ConstantPool.html#CPFieldRefEntry"><span class="hs-identifier hs-var">CPFieldRefEntry</span></a></span><span> </span><span class="annot"><span class="annottext">FieldRef
</span><a href="#local-6989586621679453508"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679453512"><span class="annot"><span class="annottext">transformMethodMHE :: MethodRef -&gt; Eff r U2
</span><a href="#local-6989586621679453512"><span class="hs-identifier hs-var hs-var hs-var">transformMethodMHE</span></a></span></span><span> </span><span id="local-6989586621679453513"><span class="annot"><span class="annottext">m :: MethodRef
</span><a href="#local-6989586621679453513"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#MethodRef"><span class="hs-identifier hs-type">MethodRef</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstantPoolEntry -&gt; Eff r U2
forall (r :: [Effect]).
(ConstantPool :&gt; r) =&gt;
ConstantPoolEntry -&gt; Eff r U2
</span><a href="JVM.Data.Convert.ConstantPool.html#findIndexOf"><span class="hs-identifier hs-var">findIndexOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodRef -&gt; ConstantPoolEntry
</span><a href="JVM.Data.Abstract.ConstantPool.html#CPMethodRefEntry"><span class="hs-identifier hs-var">CPMethodRefEntry</span></a></span><span> </span><span class="annot"><span class="annottext">MethodRef
</span><a href="#local-6989586621679453513"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679453514"><span class="annot"><a href="#local-6989586621679453514"><span class="hs-identifier hs-var">referenceKind</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679453515"><span class="annot"><a href="#local-6989586621679453515"><span class="hs-identifier hs-var">referenceIndex</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MethodHandleEntry
</span><a href="#local-6989586621679453504"><span class="hs-identifier hs-var">methodHandleEntry</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-90"></span><span>        </span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#MHGetField"><span class="hs-identifier hs-type">MHGetField</span></a></span><span> </span><span id="local-6989586621679453517"><span class="annot"><span class="annottext">FieldRef
</span><a href="#local-6989586621679453517"><span class="hs-identifier hs-var">fr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-91"></span><span>            </span><span id="local-6989586621679453518"><span class="annot"><a href="#local-6989586621679453518"><span class="hs-identifier hs-var">fri</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FieldRef -&gt; Eff r U2
forall {r :: [Effect]}. (ConstantPool :&gt; r) =&gt; FieldRef -&gt; Eff r U2
</span><a href="#local-6989586621679453507"><span class="hs-identifier hs-var">transformFieldMHE</span></a></span><span> </span><span class="annot"><span class="annottext">FieldRef
</span><a href="#local-6989586621679453517"><span class="hs-identifier hs-var">fr</span></a></span><span>
</span><span id="line-92"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Raw.MagicNumbers.html#_REF_getField"><span class="hs-identifier hs-type">_REF_getField</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679453518"><span class="hs-identifier hs-type">fri</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>        </span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#MHGetStatic"><span class="hs-identifier hs-type">MHGetStatic</span></a></span><span> </span><span id="local-6989586621679453521"><span class="annot"><span class="annottext">FieldRef
</span><a href="#local-6989586621679453521"><span class="hs-identifier hs-var">fr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-94"></span><span>            </span><span id="local-6989586621679453522"><span class="annot"><a href="#local-6989586621679453522"><span class="hs-identifier hs-var">fri</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FieldRef -&gt; Eff r U2
forall {r :: [Effect]}. (ConstantPool :&gt; r) =&gt; FieldRef -&gt; Eff r U2
</span><a href="#local-6989586621679453507"><span class="hs-identifier hs-var">transformFieldMHE</span></a></span><span> </span><span class="annot"><span class="annottext">FieldRef
</span><a href="#local-6989586621679453521"><span class="hs-identifier hs-var">fr</span></a></span><span>
</span><span id="line-95"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Raw.MagicNumbers.html#_REF_getStatic"><span class="hs-identifier hs-type">_REF_getStatic</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679453522"><span class="hs-identifier hs-type">fri</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>        </span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#MHPutField"><span class="hs-identifier hs-type">MHPutField</span></a></span><span> </span><span id="local-6989586621679453525"><span class="annot"><span class="annottext">FieldRef
</span><a href="#local-6989586621679453525"><span class="hs-identifier hs-var">fr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-97"></span><span>            </span><span id="local-6989586621679453526"><span class="annot"><a href="#local-6989586621679453526"><span class="hs-identifier hs-var">fri</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FieldRef -&gt; Eff r U2
forall {r :: [Effect]}. (ConstantPool :&gt; r) =&gt; FieldRef -&gt; Eff r U2
</span><a href="#local-6989586621679453507"><span class="hs-identifier hs-var">transformFieldMHE</span></a></span><span> </span><span class="annot"><span class="annottext">FieldRef
</span><a href="#local-6989586621679453525"><span class="hs-identifier hs-var">fr</span></a></span><span>
</span><span id="line-98"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Raw.MagicNumbers.html#_REF_putField"><span class="hs-identifier hs-type">_REF_putField</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679453526"><span class="hs-identifier hs-type">fri</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>        </span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#MHPutStatic"><span class="hs-identifier hs-type">MHPutStatic</span></a></span><span> </span><span id="local-6989586621679453529"><span class="annot"><span class="annottext">FieldRef
</span><a href="#local-6989586621679453529"><span class="hs-identifier hs-var">fr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-100"></span><span>            </span><span id="local-6989586621679453530"><span class="annot"><a href="#local-6989586621679453530"><span class="hs-identifier hs-var">fri</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FieldRef -&gt; Eff r U2
forall {r :: [Effect]}. (ConstantPool :&gt; r) =&gt; FieldRef -&gt; Eff r U2
</span><a href="#local-6989586621679453507"><span class="hs-identifier hs-var">transformFieldMHE</span></a></span><span> </span><span class="annot"><span class="annottext">FieldRef
</span><a href="#local-6989586621679453529"><span class="hs-identifier hs-var">fr</span></a></span><span>
</span><span id="line-101"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Raw.MagicNumbers.html#_REF_putStatic"><span class="hs-identifier hs-type">_REF_putStatic</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679453530"><span class="hs-identifier hs-type">fri</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>        </span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#MHInvokeVirtual"><span class="hs-identifier hs-type">MHInvokeVirtual</span></a></span><span> </span><span id="local-6989586621679453533"><span class="annot"><span class="annottext">MethodRef
</span><a href="#local-6989586621679453533"><span class="hs-identifier hs-var">mr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-103"></span><span>            </span><span id="local-6989586621679453534"><span class="annot"><a href="#local-6989586621679453534"><span class="hs-identifier hs-var">mri</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MethodRef -&gt; Eff r U2
forall {r :: [Effect]}.
(ConstantPool :&gt; r) =&gt;
MethodRef -&gt; Eff r U2
</span><a href="#local-6989586621679453512"><span class="hs-identifier hs-var">transformMethodMHE</span></a></span><span> </span><span class="annot"><span class="annottext">MethodRef
</span><a href="#local-6989586621679453533"><span class="hs-identifier hs-var">mr</span></a></span><span>
</span><span id="line-104"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Raw.MagicNumbers.html#_REF_invokeVirtual"><span class="hs-identifier hs-type">_REF_invokeVirtual</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679453534"><span class="hs-identifier hs-type">mri</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>        </span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#MHNewInvokeSpecial"><span class="hs-identifier hs-type">MHNewInvokeSpecial</span></a></span><span> </span><span id="local-6989586621679453537"><span class="annot"><span class="annottext">MethodRef
</span><a href="#local-6989586621679453537"><span class="hs-identifier hs-var">mr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-106"></span><span>            </span><span id="local-6989586621679453538"><span class="annot"><a href="#local-6989586621679453538"><span class="hs-identifier hs-var">mri</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MethodRef -&gt; Eff r U2
forall {r :: [Effect]}.
(ConstantPool :&gt; r) =&gt;
MethodRef -&gt; Eff r U2
</span><a href="#local-6989586621679453512"><span class="hs-identifier hs-var">transformMethodMHE</span></a></span><span> </span><span class="annot"><span class="annottext">MethodRef
</span><a href="#local-6989586621679453537"><span class="hs-identifier hs-var">mr</span></a></span><span>
</span><span id="line-107"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Raw.MagicNumbers.html#_REF_newInvokeSpecial"><span class="hs-identifier hs-type">_REF_newInvokeSpecial</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679453538"><span class="hs-identifier hs-type">mri</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>        </span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#MHInvokeStatic"><span class="hs-identifier hs-type">MHInvokeStatic</span></a></span><span> </span><span id="local-6989586621679453541"><span class="annot"><span class="annottext">MethodRef
</span><a href="#local-6989586621679453541"><span class="hs-identifier hs-var">mr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-109"></span><span>            </span><span id="local-6989586621679453542"><span class="annot"><a href="#local-6989586621679453542"><span class="hs-identifier hs-var">mri</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MethodRef -&gt; Eff r U2
forall {r :: [Effect]}.
(ConstantPool :&gt; r) =&gt;
MethodRef -&gt; Eff r U2
</span><a href="#local-6989586621679453512"><span class="hs-identifier hs-var">transformMethodMHE</span></a></span><span> </span><span class="annot"><span class="annottext">MethodRef
</span><a href="#local-6989586621679453541"><span class="hs-identifier hs-var">mr</span></a></span><span>
</span><span id="line-110"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Raw.MagicNumbers.html#_REF_invokeStatic"><span class="hs-identifier hs-type">_REF_invokeStatic</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679453542"><span class="hs-identifier hs-type">mri</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>        </span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#MHInvokeSpecial"><span class="hs-identifier hs-type">MHInvokeSpecial</span></a></span><span> </span><span id="local-6989586621679453545"><span class="annot"><span class="annottext">MethodRef
</span><a href="#local-6989586621679453545"><span class="hs-identifier hs-var">mr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-112"></span><span>            </span><span id="local-6989586621679453546"><span class="annot"><a href="#local-6989586621679453546"><span class="hs-identifier hs-var">mri</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MethodRef -&gt; Eff r U2
forall {r :: [Effect]}.
(ConstantPool :&gt; r) =&gt;
MethodRef -&gt; Eff r U2
</span><a href="#local-6989586621679453512"><span class="hs-identifier hs-var">transformMethodMHE</span></a></span><span> </span><span class="annot"><span class="annottext">MethodRef
</span><a href="#local-6989586621679453545"><span class="hs-identifier hs-var">mr</span></a></span><span>
</span><span id="line-113"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Raw.MagicNumbers.html#_REF_invokeSpecial"><span class="hs-identifier hs-type">_REF_invokeSpecial</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679453546"><span class="hs-identifier hs-type">mri</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>        </span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#MHInvokeInterface"><span class="hs-identifier hs-type">MHInvokeInterface</span></a></span><span> </span><span id="local-6989586621679453549"><span class="annot"><span class="annottext">MethodRef
</span><a href="#local-6989586621679453549"><span class="hs-identifier hs-var">mr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-115"></span><span>            </span><span id="local-6989586621679453550"><span class="annot"><a href="#local-6989586621679453550"><span class="hs-identifier hs-var">mri</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MethodRef -&gt; Eff r U2
forall {r :: [Effect]}.
(ConstantPool :&gt; r) =&gt;
MethodRef -&gt; Eff r U2
</span><a href="#local-6989586621679453512"><span class="hs-identifier hs-var">transformMethodMHE</span></a></span><span> </span><span class="annot"><span class="annottext">MethodRef
</span><a href="#local-6989586621679453549"><span class="hs-identifier hs-var">mr</span></a></span><span>
</span><span id="line-116"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Raw.MagicNumbers.html#_REF_invokeInterface"><span class="hs-identifier hs-type">_REF_invokeInterface</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679453550"><span class="hs-identifier hs-type">mri</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>    </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMCP"><span class="hs-identifier hs-type">lookupOrInsertMCP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Raw.ConstantPool.html#MethodHandleInfo"><span class="hs-identifier hs-type">MethodHandleInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453514"><span class="hs-identifier hs-type">referenceKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453515"><span class="hs-identifier hs-type">referenceIndex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-var">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#CPInvokeDynamicEntry"><span class="hs-identifier hs-type">CPInvokeDynamicEntry</span></a></span><span> </span><span id="local-6989586621679453554"><span class="annot"><span class="annottext">BootstrapMethod
</span><a href="#local-6989586621679453554"><span class="hs-identifier hs-var">bootstrapMethod</span></a></span></span><span> </span><span id="local-6989586621679453555"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679453555"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679453556"><span class="annot"><span class="annottext">MethodDescriptor
</span><a href="#local-6989586621679453556"><span class="hs-identifier hs-var">methodDescriptor</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-119"></span><span>    </span><span id="local-6989586621679453557"><span class="annot"><a href="#local-6989586621679453557"><span class="hs-identifier hs-var">nameAndTypeIndex</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ConstantPoolEntry -&gt; Eff r U2
forall (r :: [Effect]).
(ConstantPool :&gt; r) =&gt;
ConstantPoolEntry -&gt; Eff r U2
</span><a href="JVM.Data.Convert.ConstantPool.html#findIndexOf"><span class="hs-identifier hs-var">findIndexOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; ConstantPoolEntry
</span><a href="JVM.Data.Abstract.ConstantPool.html#CPNameAndTypeEntry"><span class="hs-identifier hs-var">CPNameAndTypeEntry</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679453555"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodDescriptor -&gt; Text
</span><a href="JVM.Data.Convert.Descriptor.html#convertMethodDescriptor"><span class="hs-identifier hs-var">convertMethodDescriptor</span></a></span><span> </span><span class="annot"><span class="annottext">MethodDescriptor
</span><a href="#local-6989586621679453556"><span class="hs-identifier hs-var">methodDescriptor</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>    </span><span id="local-6989586621679453558"><span class="annot"><a href="#local-6989586621679453558"><span class="hs-identifier hs-var">bmIndex</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#convertBootstrapMethod"><span class="hs-identifier hs-type">convertBootstrapMethod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453554"><span class="hs-identifier hs-type">bootstrapMethod</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMCP"><span class="hs-identifier hs-type">lookupOrInsertMCP</span></a></span><span>
</span><span id="line-122"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="JVM.Data.Raw.ConstantPool.html#InvokeDynamicInfo"><span class="hs-identifier hs-type">InvokeDynamicInfo</span></a></span><span>
</span><span id="line-123"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621679453558"><span class="hs-identifier hs-type">bmIndex</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-comment">-- bootstrap methods are 0 indexed because of course they are</span><span>
</span><span id="line-124"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621679453557"><span class="hs-identifier hs-type">nameAndTypeIndex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-var">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#CPMethodTypeEntry"><span class="hs-identifier hs-type">CPMethodTypeEntry</span></a></span><span> </span><span id="local-6989586621679453562"><span class="annot"><span class="annottext">MethodDescriptor
</span><a href="#local-6989586621679453562"><span class="hs-identifier hs-var">methodDescriptor</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-128"></span><span>    </span><span id="local-6989586621679453563"><span class="annot"><a href="#local-6989586621679453563"><span class="hs-identifier hs-var">descriptorIndex</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ConstantPoolEntry -&gt; Eff r Int
forall (r :: [Effect]).
(ConstantPool :&gt; r) =&gt;
ConstantPoolEntry -&gt; Eff r Int
</span><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-var">transformEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ConstantPoolEntry
</span><a href="JVM.Data.Abstract.ConstantPool.html#CPUTF8Entry"><span class="hs-identifier hs-var">CPUTF8Entry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodDescriptor -&gt; Text
</span><a href="JVM.Data.Convert.Descriptor.html#convertMethodDescriptor"><span class="hs-identifier hs-var">convertMethodDescriptor</span></a></span><span> </span><span class="annot"><span class="annottext">MethodDescriptor
</span><a href="#local-6989586621679453562"><span class="hs-identifier hs-var">methodDescriptor</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMCP"><span class="hs-identifier hs-type">lookupOrInsertMCP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Raw.ConstantPool.html#MethodTypeInfo"><span class="hs-identifier hs-type">MethodTypeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621679453563"><span class="hs-identifier hs-type">descriptorIndex</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span id="local-6989586621679453114"><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#convertBootstrapMethod"><span class="hs-identifier hs-type">convertBootstrapMethod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPool"><span class="hs-identifier hs-type">ConstantPool</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453114"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#BootstrapMethod"><span class="hs-identifier hs-type">BootstrapMethod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453114"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-132"></span><span id="convertBootstrapMethod"><span class="annot"><span class="annottext">convertBootstrapMethod :: forall (r :: [Effect]).
(ConstantPool :&gt; r) =&gt;
BootstrapMethod -&gt; Eff r Int
</span><a href="JVM.Data.Convert.ConstantPool.html#convertBootstrapMethod"><span class="hs-identifier hs-var hs-var">convertBootstrapMethod</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#BootstrapMethod"><span class="hs-identifier hs-type">BootstrapMethod</span></a></span><span> </span><span id="local-6989586621679453577"><span class="annot"><span class="annottext">MethodHandleEntry
</span><a href="#local-6989586621679453577"><span class="hs-identifier hs-var">mhEntry</span></a></span></span><span> </span><span id="local-6989586621679453578"><span class="annot"><span class="annottext">[BootstrapArgument]
</span><a href="#local-6989586621679453578"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-133"></span><span>    </span><span id="local-6989586621679453579"><span class="annot"><a href="#local-6989586621679453579"><span class="hs-identifier hs-var">mhIndex</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ConstantPoolEntry -&gt; Eff r U2
forall (r :: [Effect]).
(ConstantPool :&gt; r) =&gt;
ConstantPoolEntry -&gt; Eff r U2
</span><a href="JVM.Data.Convert.ConstantPool.html#findIndexOf"><span class="hs-identifier hs-var">findIndexOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodHandleEntry -&gt; ConstantPoolEntry
</span><a href="JVM.Data.Abstract.ConstantPool.html#CPMethodHandleEntry"><span class="hs-identifier hs-var">CPMethodHandleEntry</span></a></span><span> </span><span class="annot"><span class="annottext">MethodHandleEntry
</span><a href="#local-6989586621679453577"><span class="hs-identifier hs-var">mhEntry</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>    </span><span id="local-6989586621679453580"><span class="annot"><a href="#local-6989586621679453580"><span class="hs-identifier hs-var">bsArgs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#findIndexOf"><span class="hs-identifier hs-type">findIndexOf</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#bmArgToCPEntry"><span class="hs-identifier hs-type">bmArgToCPEntry</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679453578"><span class="hs-identifier hs-type">args</span></a></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679453584"><span class="annot"><a href="#local-6989586621679453584"><span class="hs-identifier hs-var hs-var">bootstrapMethod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">U2 -&gt; Vector U2 -&gt; BootstrapMethod
</span><a href="JVM.Data.Raw.ClassFile.html#BootstrapMethod"><span class="hs-identifier hs-var">Raw.BootstrapMethod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">U2 -&gt; U2
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">U2
</span><a href="#local-6989586621679453579"><span class="hs-identifier hs-var">mhIndex</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[U2] -&gt; Vector U2
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">[U2]
</span><a href="#local-6989586621679453580"><span class="hs-identifier hs-var">bsArgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#lookupOrInsertMBM"><span class="hs-identifier hs-type">lookupOrInsertMBM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453584"><span class="hs-identifier hs-type">bootstrapMethod</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679453589"><span id="local-6989586621679453593"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPoolState"><span class="hs-identifier hs-type">ConstantPoolState</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPoolState"><span class="hs-identifier hs-type">ConstantPoolState</span></a></span><span> </span><span id="local-6989586621679453603"><span class="annot"><span class="annottext">IndexedMap ConstantPoolInfo
</span><a href="#local-6989586621679453603"><span class="hs-identifier hs-var">cp1</span></a></span></span><span> </span><span id="local-6989586621679453604"><span class="annot"><span class="annottext">IndexedMap BootstrapMethod
</span><a href="#local-6989586621679453604"><span class="hs-identifier hs-var">bm1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679453605"><span class="annot"><span class="annottext">&lt;&gt; :: ConstantPoolState -&gt; ConstantPoolState -&gt; ConstantPoolState
</span><span class="hs-operator hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPoolState"><span class="hs-identifier hs-type">ConstantPoolState</span></a></span><span> </span><span id="local-6989586621679453606"><span class="annot"><span class="annottext">IndexedMap ConstantPoolInfo
</span><a href="#local-6989586621679453606"><span class="hs-identifier hs-var">cp2</span></a></span></span><span> </span><span id="local-6989586621679453607"><span class="annot"><span class="annottext">IndexedMap BootstrapMethod
</span><a href="#local-6989586621679453607"><span class="hs-identifier hs-var">bm2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IndexedMap ConstantPoolInfo
-&gt; IndexedMap BootstrapMethod -&gt; ConstantPoolState
</span><a href="JVM.Data.Convert.ConstantPool.html#ConstantPoolState"><span class="hs-identifier hs-var">ConstantPoolState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IndexedMap ConstantPoolInfo
</span><a href="#local-6989586621679453603"><span class="hs-identifier hs-var">cp1</span></a></span><span> </span><span class="annot"><span class="annottext">IndexedMap ConstantPoolInfo
-&gt; IndexedMap ConstantPoolInfo -&gt; IndexedMap ConstantPoolInfo
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">IndexedMap ConstantPoolInfo
</span><a href="#local-6989586621679453606"><span class="hs-identifier hs-var">cp2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IndexedMap BootstrapMethod
</span><a href="#local-6989586621679453604"><span class="hs-identifier hs-var">bm1</span></a></span><span> </span><span class="annot"><span class="annottext">IndexedMap BootstrapMethod
-&gt; IndexedMap BootstrapMethod -&gt; IndexedMap BootstrapMethod
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">IndexedMap BootstrapMethod
</span><a href="#local-6989586621679453607"><span class="hs-identifier hs-var">bm2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679453612"><span id="local-6989586621679453616"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPoolState"><span class="hs-identifier hs-type">ConstantPoolState</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-142"></span><span>    </span><span id="local-6989586621679453624"><span class="annot"><span class="annottext">mempty :: ConstantPoolState
</span><span class="hs-identifier hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IndexedMap ConstantPoolInfo
-&gt; IndexedMap BootstrapMethod -&gt; ConstantPoolState
</span><a href="JVM.Data.Convert.ConstantPool.html#ConstantPoolState"><span class="hs-identifier hs-var">ConstantPoolState</span></a></span><span> </span><span class="annot"><span class="annottext">IndexedMap ConstantPoolInfo
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">IndexedMap BootstrapMethod
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span id="local-6989586621679453111"><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#findIndexOf"><span class="hs-identifier hs-type">findIndexOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPool"><span class="hs-identifier hs-type">ConstantPool</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453111"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="JVM.Data.Abstract.ConstantPool.html#ConstantPoolEntry"><span class="hs-identifier hs-type">ConstantPoolEntry</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679453111"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="JVM.Data.Raw.Types.html#U2"><span class="hs-identifier hs-type">U2</span></a></span></span><span>
</span><span id="line-145"></span><span id="findIndexOf"><span class="annot"><span class="annottext">findIndexOf :: forall (r :: [Effect]).
(ConstantPool :&gt; r) =&gt;
ConstantPoolEntry -&gt; Eff r U2
</span><a href="JVM.Data.Convert.ConstantPool.html#findIndexOf"><span class="hs-identifier hs-var hs-var">findIndexOf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; U2) -&gt; Eff r Int -&gt; Eff r U2
forall a b. (a -&gt; b) -&gt; Eff r a -&gt; Eff r b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; U2
</span><a href="#local-6989586621679453639"><span class="hs-identifier hs-var">toU2OrError</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff r Int -&gt; Eff r U2)
-&gt; (ConstantPoolEntry -&gt; Eff r Int)
-&gt; ConstantPoolEntry
-&gt; Eff r U2
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConstantPoolEntry -&gt; Eff r Int
forall (r :: [Effect]).
(ConstantPool :&gt; r) =&gt;
ConstantPoolEntry -&gt; Eff r Int
</span><a href="JVM.Data.Convert.ConstantPool.html#transformEntry"><span class="hs-identifier hs-var">transformEntry</span></a></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><a href="#local-6989586621679453639"><span class="hs-identifier hs-type">toU2OrError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="JVM.Data.Raw.Types.html#U2"><span class="hs-identifier hs-type">U2</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span id="local-6989586621679453639"><span class="annot"><span class="annottext">toU2OrError :: Int -&gt; U2
</span><a href="#local-6989586621679453639"><span class="hs-identifier hs-var hs-var">toU2OrError</span></a></span></span><span> </span><span id="local-6989586621679453640"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679453640"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-149"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679453640"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">U2 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="JVM.Data.Raw.Types.html#U2"><span class="hs-identifier hs-type">U2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; U2
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Constant pool index out of bounds, too many entries?&quot;</span></span><span>
</span><span id="line-151"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; U2
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679453640"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span id="local-6989586621679453142"><span id="local-6989586621679453143"><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#constantPoolToState"><span class="hs-identifier hs-type">constantPoolToState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.State.Static.Local.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPoolState"><span class="hs-identifier hs-type">ConstantPoolState</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Internal.Effect.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453142"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPool"><span class="hs-identifier hs-type">ConstantPool</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679453142"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679453143"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453142"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453143"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-154"></span><span id="constantPoolToState"><span class="annot"><span class="annottext">constantPoolToState :: forall (r :: [Effect]) a.
(State ConstantPoolState :&gt; r) =&gt;
Eff (ConstantPool : r) a -&gt; Eff r a
</span><a href="JVM.Data.Convert.ConstantPool.html#constantPoolToState"><span class="hs-identifier hs-var hs-var">constantPoolToState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EffectHandler ConstantPool r -&gt; Eff (ConstantPool : r) a -&gt; Eff r a
forall (e :: Effect) (es :: [Effect]) a.
(HasCallStack, DispatchOf e ~ 'Dynamic) =&gt;
EffectHandler e es -&gt; Eff (e : es) a -&gt; Eff es a
</span><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Dispatch.Dynamic.html#interpret"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="annot"><span class="annottext">(EffectHandler ConstantPool r
 -&gt; Eff (ConstantPool : r) a -&gt; Eff r a)
-&gt; EffectHandler ConstantPool r
-&gt; Eff (ConstantPool : r) a
-&gt; Eff r a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">LocalEnv localEs r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><span class="annottext">ConstantPool (Eff localEs) a
</span><a href="JVM.Data.Convert.ConstantPool.html#GetCP"><span class="hs-identifier hs-var">GetCP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; Eff r a
forall s (es :: [Effect]) a.
(HasCallStack, State s :&gt; es) =&gt;
(s -&gt; a) -&gt; Eff es a
</span><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.State.Static.Local.html#gets"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#SetCP"><span class="hs-identifier hs-type">SetCP</span></a></span><span> </span><span id="local-6989586621679453661"><span class="annot"><span class="annottext">ConstantPoolState
</span><a href="#local-6989586621679453661"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ConstantPoolState -&gt; ConstantPoolState) -&gt; Eff r ()
forall s (es :: [Effect]).
(HasCallStack, State s :&gt; es) =&gt;
(s -&gt; s) -&gt; Eff es ()
</span><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.State.Static.Local.html#modify"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConstantPoolState -&gt; ConstantPoolState -&gt; ConstantPoolState
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">ConstantPoolState
</span><a href="#local-6989586621679453661"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span id="local-6989586621679453161"><span id="local-6989586621679453162"><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#runConstantPoolWith"><span class="hs-identifier hs-type">runConstantPoolWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPoolState"><span class="hs-identifier hs-type">ConstantPoolState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPool"><span class="hs-identifier hs-type">ConstantPool</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679453161"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679453162"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453161"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679453162"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPoolState"><span class="hs-identifier hs-type">ConstantPoolState</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-159"></span><span id="runConstantPoolWith"><span class="annot"><span class="annottext">runConstantPoolWith :: forall (r :: [Effect]) a.
ConstantPoolState
-&gt; Eff (ConstantPool : r) a -&gt; Eff r (a, ConstantPoolState)
</span><a href="JVM.Data.Convert.ConstantPool.html#runConstantPoolWith"><span class="hs-identifier hs-var hs-var">runConstantPoolWith</span></a></span></span><span> </span><span id="local-6989586621679453685"><span class="annot"><span class="annottext">ConstantPoolState
</span><a href="#local-6989586621679453685"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-160"></span><span>    </span><span>
</span><span id="line-161"></span><span>        </span><span class="annot"><span class="annottext">ConstantPoolState
-&gt; Eff (State ConstantPoolState : r) a
-&gt; Eff r (a, ConstantPoolState)
forall s (es :: [Effect]) a.
HasCallStack =&gt;
s -&gt; Eff (State s : es) a -&gt; Eff es (a, s)
</span><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.State.Static.Local.html#runState"><span class="hs-identifier hs-var">runState</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantPoolState
</span><a href="#local-6989586621679453685"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-162"></span><span>        </span><span class="annot"><span class="annottext">(Eff (State ConstantPoolState : r) a
 -&gt; Eff r (a, ConstantPoolState))
-&gt; (Eff (ConstantPool : r) a
    -&gt; Eff (State ConstantPoolState : r) a)
-&gt; Eff (ConstantPool : r) a
-&gt; Eff r (a, ConstantPoolState)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Eff (ConstantPool : State ConstantPoolState : r) a
-&gt; Eff (State ConstantPoolState : r) a
forall (r :: [Effect]) a.
(State ConstantPoolState :&gt; r) =&gt;
Eff (ConstantPool : r) a -&gt; Eff r a
</span><a href="JVM.Data.Convert.ConstantPool.html#constantPoolToState"><span class="hs-identifier hs-var">constantPoolToState</span></a></span><span>
</span><span id="line-163"></span><span>        </span><span class="annot"><span class="annottext">(Eff (ConstantPool : State ConstantPoolState : r) a
 -&gt; Eff (State ConstantPoolState : r) a)
-&gt; (Eff (ConstantPool : r) a
    -&gt; Eff (ConstantPool : State ConstantPoolState : r) a)
-&gt; Eff (ConstantPool : r) a
-&gt; Eff (State ConstantPoolState : r) a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Eff (ConstantPool : r) a
-&gt; Eff (ConstantPool : State ConstantPoolState : r) a
forall (subEs :: [Effect]) (es :: [Effect]) a.
Subset subEs es =&gt;
Eff subEs a -&gt; Eff es a
</span><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Internal.Monad.html#inject"><span class="hs-identifier hs-var">inject</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span id="local-6989586621679453189"><span id="local-6989586621679453190"><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#runConstantPool"><span class="hs-identifier hs-type">runConstantPool</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPool"><span class="hs-identifier hs-type">ConstantPool</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679453189"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679453190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/0paykgqig9fvsxqr1qva6mhdi2ydy70l-effectful-core-2.6.1.0-doc/share/doc/effectful-core-2.6.1.0/html/src/Effectful.Internal.Monad.html#Eff"><span class="hs-identifier hs-type">Eff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453189"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679453190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="JVM.Data.Convert.ConstantPool.html#ConstantPoolState"><span class="hs-identifier hs-type">ConstantPoolState</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-166"></span><span id="runConstantPool"><span class="annot"><span class="annottext">runConstantPool :: forall (r :: [Effect]) a.
Eff (ConstantPool : r) a -&gt; Eff r (a, ConstantPoolState)
</span><a href="JVM.Data.Convert.ConstantPool.html#runConstantPool"><span class="hs-identifier hs-var hs-var">runConstantPool</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstantPoolState
-&gt; Eff (ConstantPool : r) a -&gt; Eff r (a, ConstantPoolState)
forall (r :: [Effect]) a.
ConstantPoolState
-&gt; Eff (ConstantPool : r) a -&gt; Eff r (a, ConstantPoolState)
</span><a href="JVM.Data.Convert.ConstantPool.html#runConstantPoolWith"><span class="hs-identifier hs-var">runConstantPoolWith</span></a></span><span> </span><span class="annot"><span class="annottext">ConstantPoolState
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-167"></span></pre></body></html>